
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Example &#8212; Django roles 0.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Test" href="test.html" />
    <link rel="prev" title="Notes" href="notes.html" />



 
<script type="text/javascript" src="templatebuiltins.js"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="index.html">Django roles 0.1 documentation</a></h1>
      <div id="global-nav">
        <a title="Home page" href="index.html">Home</a>  |
        <a title="Table of contents" href="contents.html">Table of contents</a>  |
        <a title="Global index" href="genindex.html">Index</a>  |
        <a title="Module index" href="py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="notes.html" title="Notes">previous</a>
     |
    <a title="Django roles 0.1 documentation" href="index.html" accesskey="U">up</a>
   |
    <a href="test.html" title="Test">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="example">
            
  <div class="section" id="example">
<h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-example-django-project">
<span id="id1"></span><h2>Create example Django project<a class="headerlink" href="#create-example-django-project" title="Permalink to this headline">¶</a></h2>
<p>This tutorial will explain how to use Django-Roles. For this is necessary a
simple Django project and application. With the spirit of standard this
tutorial use Django’s documentation <em>polls</em> example. This example can be found
at <a class="reference external" href="https://docs.djangoproject.com/en/2.0/intro/tutorial01/">Django_example</a>.</p>
<div class="section" id="create-project-and-application">
<span id="create-proyect-and-application"></span><h3>1 Create project and application<a class="headerlink" href="#create-project-and-application" title="Permalink to this headline">¶</a></h3>
<p>Start by creating a Django project::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">django</span><span class="o">-</span><span class="n">admin</span> <span class="n">startproject</span> <span class="n">mysite</span>
</pre></div>
</div>
<p>Once the project has been created, proceed to create a new application::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">mysite</span>
<span class="n">python</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">startapp</span> <span class="n">polls</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Now there are Django project and application. Let write some simple code. First</dt>
<dd>step will be to add <em>myapp</em> to <a class="reference external" href="http://docs.djangoproject.com/en/dev/ref/settings/#std:setting-INSTALLED_APPS" title="(in Django v2.2)"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a></dd>
</dl>
<div class="literal-block-wrapper docutils container" id="mysite-settings-py">
<div class="code-block-caption"><span class="caption-text">mysite/settings.py</span><a class="headerlink" href="#mysite-settings-py" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">INSTALLED_APPS = [</span>
<span class="x">    ...</span>
<span class="x">    &#39;polls&#39;,</span>
<span class="x">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-examples-models">
<span id="create-example-models"></span><h3>2 Create examples models<a class="headerlink" href="#create-examples-models" title="Permalink to this headline">¶</a></h3>
<p>In <em>models.py</em> in <em>polls</em> folder add the code used by Django project in polls
example:</p>
<div class="literal-block-wrapper docutils container" id="polls-models-py">
<div class="code-block-caption"><span class="caption-text">polls/models.py</span><a class="headerlink" href="#polls-models-py" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">import datetime</span>

<span class="x">from django.db import models</span>
<span class="x">from django.utils import timezone</span>


<span class="x">class Question(models.Model):</span>
<span class="x">    question_text = models.CharField(max_length=200)</span>
<span class="x">    pub_date = models.DateTimeField(&#39;date published&#39;)</span>

<span class="x">    def __str__(self):</span>
<span class="x">        return self.question_text</span>

<span class="x">    def was_published_recently(self):</span>
<span class="x">        return self.pub_date &gt;= timezone.now() - datetime.timedelta(days=1)</span>


<span class="x">class Choice(models.Model):</span>
<span class="x">    question = models.ForeignKey(Question, on_delete=models.CASCADE)</span>
<span class="x">    choice_text = models.CharField(max_length=200)</span>
<span class="x">    votes = models.IntegerField(default=0)</span>

<span class="x">    def __str__(self):</span>
<span class="x">        return self.choice_text</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-examples-views">
<span id="create-example-views"></span><h3>3 Create examples views<a class="headerlink" href="#create-examples-views" title="Permalink to this headline">¶</a></h3>
<p>In <em>views.py</em> in <em>polss</em> folder add the code used by Django project in polls
example:</p>
<div class="literal-block-wrapper docutils container" id="polls-views-py">
<div class="code-block-caption"><span class="caption-text">polls/views.py</span><a class="headerlink" href="#polls-views-py" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">from django.http import HttpResponseRedirect</span>
<span class="x">from django.shortcuts import get_object_or_404, render</span>
<span class="x">from django.urls import reverse</span>
<span class="x">from django.views import generic</span>

<span class="x">from .models import Choice, Question</span>


<span class="x">class IndexView(generic.ListView):</span>
<span class="x">    template_name = &#39;polls/index.html&#39;</span>
<span class="x">    context_object_name = &#39;latest_question_list&#39;</span>

<span class="x">    def get_queryset(self):</span>
<span class="x">        &quot;&quot;&quot;Return the last five published questions.&quot;&quot;&quot;</span>
<span class="x">        return Question.objects.order_by(&#39;-pub_date&#39;)[:5]</span>


<span class="x">class DetailView(generic.DetailView):</span>
<span class="x">    model = Question</span>
<span class="x">    template_name = &#39;polls/detail.html&#39;</span>


<span class="x">class ResultsView(generic.DetailView):</span>
<span class="x">    model = Question</span>
<span class="x">    template_name = &#39;polls/results.html&#39;</span>


<span class="x">def vote(request, question_id):</span>
<span class="x">    question = get_object_or_404(Question, pk=question_id)</span>
<span class="x">    try:</span>
<span class="x">        selected_choice = question.choice_set.get(pk=request.POST[&#39;choice&#39;])</span>
<span class="x">    except (KeyError, Choice.DoesNotExist):</span>
<span class="x">        # Redisplay the question voting form.</span>
<span class="x">        return render(request, &#39;polls/detail.html&#39;, {</span>
<span class="x">            &#39;question&#39;: question,</span>
<span class="x">            &#39;error_message&#39;: &quot;You didn&#39;t select a choice.&quot;,</span>
<span class="x">        })</span>
<span class="x">    else:</span>
<span class="x">        selected_choice.votes += 1</span>
<span class="x">        selected_choice.save()</span>
<span class="x">        # Always return an HttpResponseRedirect after successfully dealing</span>
<span class="x">        # with POST data. This prevents data from being posted twice if a</span>
<span class="x">        # user hits the Back button.</span>
<span class="x">        return HttpResponseRedirect(reverse(&#39;polls:results&#39;,</span>
<span class="x">                                            args=(question.id,)</span>
<span class="x">                                           ))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configure-urlconf">
<span id="id2"></span><h3>4 Configure URLConf<a class="headerlink" href="#configure-urlconf" title="Permalink to this headline">¶</a></h3>
<p>Update <em>mysite/urls.py</em> to have next code:</p>
<div class="literal-block-wrapper docutils container" id="mysite-urls-py">
<div class="code-block-caption"><span class="caption-text">mysite/urls.py</span><a class="headerlink" href="#mysite-urls-py" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">from django.contrib import admin</span>
<span class="x">from django.urls import include, path</span>

<span class="x">urlpatterns = [</span>
<span class="x">    path(&#39;polls/&#39;, include(&#39;polls.urls&#39;)),</span>
<span class="x">    path(&#39;admin/&#39;, admin.site.urls),</span>
<span class="x">]</span>
</pre></div>
</div>
</div>
<p>Create a new file in <em>polls</em> directory with the name <em>urls.py</em> and copy the
content from the example in Django documentations.</p>
<div class="literal-block-wrapper docutils container" id="polls-urls-py">
<div class="code-block-caption"><span class="caption-text">polls/urls.py</span><a class="headerlink" href="#polls-urls-py" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">from django.urls import path</span>

<span class="x">from . import views</span>

<span class="x">app_name = &#39;polls&#39;</span>
<span class="x">urlpatterns = [</span>
<span class="x">    path(&#39;&#39;, views.IndexView.as_view(), name=&#39;index&#39;),</span>
<span class="x">    path(&#39;&lt;int:pk&gt;/&#39;, views.DetailView.as_view(), name=&#39;detail&#39;),</span>
<span class="x">    path(&#39;&lt;int:pk&gt;/results/&#39;, views.ResultsView.as_view(), name=&#39;results&#39;),</span>
<span class="x">    path(&#39;&lt;int:question_id&gt;/vote/&#39;, views.vote, name=&#39;vote&#39;),</span>
<span class="x">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configure-for-admin-site">
<span id="id3"></span><h3>5 Configure for Admin site<a class="headerlink" href="#configure-for-admin-site" title="Permalink to this headline">¶</a></h3>
<p>In <em>polls/admin.py</em> add the next code:</p>
<div class="literal-block-wrapper docutils container" id="polls-admin-py">
<div class="code-block-caption"><span class="caption-text">polls/admin.py</span><a class="headerlink" href="#polls-admin-py" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">from django.contrib import admin</span>
<span class="x">from .models import Question, Choice</span>

<span class="x">admin.site.register(Question)</span>
<span class="x">admin.site.register(Choice)</span>
</pre></div>
</div>
</div>
<p>I modify this so you can add Choice in the admin.</p>
</div>
<div class="section" id="create-templates">
<span id="id4"></span><h3>6 Create templates<a class="headerlink" href="#create-templates" title="Permalink to this headline">¶</a></h3>
<p>Create directory <em>polls/templates/polls</em> and add next html files:</p>
<div class="literal-block-wrapper docutils container" id="polls-templates-polls-index-html">
<div class="code-block-caption"><span class="caption-text">polls/templates/polls/index.html</span><a class="headerlink" href="#polls-templates-polls-index-html" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">latest_question_list</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  &lt;ul&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">question</span> <span class="k">in</span> <span class="nv">latest_question_list</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">      &lt;li&gt;</span>
<span class="x">        &lt;a href=&quot;/polls/</span><span class="cp">{{</span> <span class="nv">question.id</span> <span class="cp">}}</span><span class="x">/&quot;&gt;</span><span class="cp">{{</span> <span class="nv">question.question_text</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;</span>
<span class="x">      &lt;/li&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  &lt;/ul&gt;</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  &lt;p&gt;No polls are available.&lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="polls-templates-polls-detail-html">
<div class="code-block-caption"><span class="caption-text">polls/templates/polls/detail.html</span><a class="headerlink" href="#polls-templates-polls-detail-html" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">question.question_text</span> <span class="cp">}}</span><span class="x">&lt;/h1&gt;</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">error_message</span> <span class="cp">%}</span><span class="x">&lt;p&gt;&lt;strong&gt;</span><span class="cp">{{</span> <span class="nv">error_message</span> <span class="cp">}}</span><span class="x">&lt;/strong&gt;&lt;/p&gt;</span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">  &lt;form action=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;polls:vote&#39;</span> <span class="nv">question.id</span> <span class="cp">%}</span><span class="x">&quot; method=&quot;post&quot;&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">      </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">choice</span> <span class="k">in</span> <span class="nv">question.choice_set.all</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">        &lt;input type=&quot;radio&quot; name=&quot;choice&quot; id=&quot;choice</span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.counter</span> <span class="cp">}}</span><span class="x">&quot;</span>
<span class="x">          value=&quot;</span><span class="cp">{{</span> <span class="nv">choice.id</span> <span class="cp">}}</span><span class="x">&quot; /&gt;</span>
<span class="x">        &lt;label for=&quot;choice</span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.counter</span> <span class="cp">}}</span><span class="x">&quot;&gt;</span><span class="cp">{{</span> <span class="nv">choice.choice_text</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">        &lt;/label&gt;</span>
<span class="x">        &lt;br /&gt;</span>
<span class="x">      </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;input type=&quot;submit&quot; value=&quot;Vote&quot; /&gt;</span>
<span class="x">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="polls-templates-polls-results-html">
<div class="code-block-caption"><span class="caption-text">polls/templates/polls/results.html</span><a class="headerlink" href="#polls-templates-polls-results-html" title="Permalink to this code">¶</a></div>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="x">&lt;h1&gt;</span><span class="cp">{{</span> <span class="nv">question.question_text</span> <span class="cp">}}</span><span class="x">&lt;/h1&gt;</span>

<span class="x">&lt;ul&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">choice</span> <span class="k">in</span> <span class="nv">question.choice_set.all</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;li&gt;</span>
<span class="x">      </span><span class="cp">{{</span> <span class="nv">choice.choice_text</span> <span class="cp">}}</span><span class="x"> -- </span><span class="cp">{{</span> <span class="nv">choice.votes</span> <span class="cp">}}</span><span class="x"> vote</span><span class="cp">{{</span> <span class="nv">choice.votes</span><span class="o">|</span><span class="nf">pluralize</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">    &lt;/li&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;/ul&gt;</span>

<span class="x">&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s1">&#39;polls:detail&#39;</span> <span class="nv">question.id</span> <span class="cp">%}</span><span class="x">&quot;&gt;Vote again?&lt;/a&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="installing-django-roles">
<span id="example-installing-django-roles"></span><h2>Installing Django-Roles<a class="headerlink" href="#installing-django-roles" title="Permalink to this headline">¶</a></h2>
<p>Download Django-Roles from PyPi with the command::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">django</span><span class="o">-</span><span class="n">roles</span>
</pre></div>
</div>
<p>Once installed proceed to added to <a class="reference external" href="http://docs.djangoproject.com/en/dev/ref/settings/#std:setting-INSTALLED_APPS" title="(in Django v2.2)"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Example</a><ul>
<li><a class="reference internal" href="#create-example-django-project">Create example Django project</a><ul>
<li><a class="reference internal" href="#create-project-and-application">1 Create project and application</a></li>
<li><a class="reference internal" href="#create-examples-models">2 Create examples models</a></li>
<li><a class="reference internal" href="#create-examples-views">3 Create examples views</a></li>
<li><a class="reference internal" href="#configure-urlconf">4 Configure URLConf</a></li>
<li><a class="reference internal" href="#configure-for-admin-site">5 Configure for Admin site</a></li>
<li><a class="reference internal" href="#create-templates">6 Create templates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installing-django-roles">Installing Django-Roles</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="notes.html"
                        title="previous chapter">Notes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="test.html"
                        title="next chapter">Test</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/example.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">Jan 08, 2019</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="notes.html" title="Notes">previous</a>
     |
    <a title="Django roles 0.1 documentation" href="index.html" accesskey="U">up</a>
   |
    <a href="test.html" title="Test">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>